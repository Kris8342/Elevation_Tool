<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Elevation Check Tool</title>
    <style>
        body            {font-family:Arial,sans-serif;margin:20px;line-height:1.6}
        .form-container {max-width:900px;margin:0 auto;padding:20px;
                         border:1px solid #ccc;border-radius:5px;background:#f9f9f9}
        .header         {text-align:center;margin-bottom:30px}
        .input-group    {margin-bottom:15px;display:flex;align-items:center;flex-wrap:wrap}
        .input-field    {border:none;border-bottom:1px solid #333;background:transparent;
                         padding:5px;width:200px;font-size:16px}
        .fraction-select{border:1px solid #333;background:#fff;padding:5px;width:80px;font-size:16px;border-radius:3px}
        label           {font-weight:bold;margin-right:6px;min-width:180px}
        .section-title  {font-size:18px;font-weight:bold;margin-top:20px;margin-bottom:10px;
                         border-bottom:2px solid #333;padding-bottom:5px}
        .section        {border:1px solid #ddd;padding:15px;margin-bottom:20px;border-radius:5px;background:#fff}
        .result-box     {background:#e8f5e9;border:2px solid #4CAF50;padding:15px;border-radius:5px;
                         margin:10px 0;font-size:18px;font-weight:bold}
        .error-box      {background:#ffebee;border:2px solid #f44336;padding:15px;border-radius:5px;
                         margin:10px 0;color:#d32f2f}
        .radio-group    {display:flex;gap:20px;margin:15px 0;flex-wrap:wrap}
        .radio-item     {display:flex;align-items:center;gap:5px}
        input[type=radio]{width:18px;height:18px}
        .calc-button    {padding:10px 20px;background:#2196F3;color:#fff;border:none;
                         border-radius:4px;cursor:pointer;font-size:16px;margin-top:10px}
        .calc-button:hover{background:#0b7dda}
        .diagonal-button{padding:10px 20px;background:#9c27b0;color:#fff;border:none;
                         border-radius:4px;cursor:pointer;font-size:16px;margin-top:10px}
        .diagonal-button:hover{background:#7b1fa2}
        .instructions   {background:#fff3cd;border:1px solid #ffeaa7;padding:10px;
                         border-radius:5px;margin:10px 0;font-style:italic}
        .two-column     {display:grid;grid-template-columns:1fr 1fr;gap:20px}
        @media (max-width:600px){.two-column{grid-template-columns:1fr}.radio-group{flex-direction:column}}
        @media print    {.no-print{display:none}body{margin:0}.form-container{border:none;padding:0}}
    </style>
</head>
<body>
<div class="form-container">

    <!-- HEADER TITLE -->
    <div class="header">
        <h1 style="margin:0;">Elevation Check Tool</h1>
        <p style="margin:5px 0;color:#666;">Calculate grade rod settings for footers and slabs</p>
    </div>

    <!-- FOOTER TYPE SELECTION -->
    <div class="section-title">Calculation Type</div>
    <div class="radio-group">
        <div class="radio-item">
            <input type="radio" id="basement-footer" name="footer-type" value="basement" checked onchange="toggleFooterType()">
            <label for="basement-footer" style="min-width:auto;">Basement Footer</label>
        </div>
        <div class="radio-item">
            <input type="radio" id="block-footer" name="footer-type" value="block" onchange="toggleFooterType()">
            <label for="block-footer" style="min-width:auto;">Block Footer</label>
        </div>
        <div class="radio-item">
            <input type="radio" id="diagonal-calc" name="footer-type" value="diagonal" onchange="toggleFooterType()">
            <label for="diagonal-calc" style="min-width:auto;">Diagonal Calculator</label>
        </div>
    </div>

    <!-- BASEMENT FOOTER SECTION -->
    <div id="basement-section" class="section">
        <div class="section-title">Basement Footer Calculation</div>
        
        <div class="instructions">
            Enter your current elevation point, grade rod reading, and Slab elevation. 
            The tool will calculate where to set your grade rod.
        </div>

        <div class="input-group">
            <label for="current-elevation-basement">Current Elevation Point:</label>
            <input id="current-elevation-basement" class="input-field" type="number" step="0.01" placeholder="e.g., 814.7">
            <span style="margin-left:5px;">ft</span>
        </div>

        <div class="input-group">
            <label for="grade-rod-basement">Current Grade Rod Reading:</label>
            <input id="grade-rod-ft-basement" class="input-field" type="number" step="1" placeholder="feet" style="width:60px">
            <span style="margin:0 5px;">ft</span>
            <input id="grade-rod-in-basement" class="input-field" type="number" step="1" placeholder="inches" style="width:60px">
            <span style="margin:0 5px;">in</span>
            <select id="grade-rod-fraction-basement" class="fraction-select"></select>
        </div>

        <div class="input-group">
            <label for="footer-elevation-basement">Slab Elevation:</label>
            <input id="footer-elevation-basement" class="input-field" type="number" step="0.01" placeholder="e.g., 803.56">
            <span style="margin-left:5px;">ft</span>
        </div>

        <button class="calc-button" onclick="calculateBasement()">Calculate</button>

        <div id="basement-results" style="display:none;">
            <div class="two-column">
                <div class="result-box">
                    <div>Elevation Difference:</div>
                    <div id="difference-decimal-basement">-</div>
                </div>
                <div class="result-box">
                    <div>Set Grade Rod To:</div>
                    <div id="grade-rod-setting-basement">-</div>
                </div>
            </div>
            <div class="two-column">
                <div class="result-box" style="background:#e3f2fd;border-color:#2196F3;">
                    <div>Slab Height:</div>
                    <div id="slab-height-basement">-</div>
                </div>
                <div class="result-box" style="background:#fff3e0;border-color:#ff9800;">
                    <div>Sub Grade (1ft lower):</div>
                    <div id="sub-grade-basement">-</div>
                </div>
            </div>
        </div>
    </div>

    <!-- BLOCK FOOTER SECTION -->
    <div id="block-section" class="section" style="display:none;">
        <div class="section-title">Block Footer Calculation</div>
        
        <div class="instructions">
            Enter finished floor elevation, floor system thickness, and number of block courses.
            The tool will calculate the required footer elevation and grade rod setting.
        </div>

        <div class="input-group">
            <label for="finished-floor">Finished Floor Elevation:</label>
            <input id="finished-floor" class="input-field" type="number" step="0.01" placeholder="e.g., 800.0">
            <span style="margin-left:5px;">ft</span>
        </div>

        <div class="input-group">
            <label for="floor-system">Floor System Thickness:</label>
            <input id="floor-system" class="input-field" type="number" step="0.25" placeholder="e.g., 17">
            <span style="margin-left:5px;">inches</span>
        </div>

        <div class="input-group">
            <label for="block-courses">Number of Block Courses:</label>
            <input id="block-courses" class="input-field" type="number" step="1" placeholder="e.g., 5" style="width:100px">
            <span style="margin-left:5px;">(8" per course)</span>
        </div>

        <div class="input-group">
            <label for="current-elevation-block">Current Elevation Point:</label>
            <input id="current-elevation-block" class="input-field" type="number" step="0.01" placeholder="e.g., 814.7">
            <span style="margin-left:5px;">ft</span>
        </div>

        <div class="input-group">
            <label for="grade-rod-block">Current Grade Rod Reading:</label>
            <input id="grade-rod-ft-block" class="input-field" type="number" step="1" placeholder="feet" style="width:60px">
            <span style="margin:0 5px;">ft</span>
            <input id="grade-rod-in-block" class="input-field" type="number" step="1" placeholder="inches" style="width:60px">
            <span style="margin:0 5px;">in</span>
            <select id="grade-rod-fraction-block" class="fraction-select"></select>
        </div>

        <button class="calc-button" onclick="calculateBlock()">Calculate</button>

        <div id="block-results" style="display:none;">
            <div class="result-box" style="background:#f3e5f5;border-color:#9c27b0;">
                <div>Total Deduction: <span id="total-deduction">-</span></div>
                <div>Calculated Footer Elevation: <span id="calc-footer-elevation">-</span></div>
            </div>
            <div class="two-column">
                <div class="result-box">
                    <div>Footer Height from Current:</div>
                    <div id="footer-height-decimal">-</div>
                </div>
                <div class="result-box">
                    <div>Set Grade Rod To:</div>
                    <div id="block-grade-rod-setting">-</div>
                </div>
            </div>
        </div>
    </div>

    <!-- DIAGONAL CALCULATOR SECTION -->
    <div id="diagonal-section" class="section" style="display:none;">
        <div class="section-title">Diagonal Calculator</div>
        
        <div class="instructions">
            Enter the length and width of a rectangle to calculate the diagonal measurement.
            Perfect for checking square corners on foundations and footers.
        </div>

        <div class="input-group">
            <label for="length-ft">Length:</label>
            <input id="length-ft" class="input-field" type="number" step="1" placeholder="feet" style="width:60px">
            <span style="margin:0 5px;">ft</span>
            <input id="length-in" class="input-field" type="number" step="1" placeholder="inches" style="width:60px">
            <span style="margin:0 5px;">in</span>
            <select id="length-fraction" class="fraction-select"></select>
        </div>

        <div class="input-group">
            <label for="width-ft">Width:</label>
            <input id="width-ft" class="input-field" type="number" step="1" placeholder="feet" style="width:60px">
            <span style="margin:0 5px;">ft</span>
            <input id="width-in" class="input-field" type="number" step="1" placeholder="inches" style="width:60px">
            <span style="margin:0 5px;">in</span>
            <select id="width-fraction" class="fraction-select"></select>
        </div>

        <button class="diagonal-button" onclick="calculateDiagonal()">Calculate Diagonal</button>

        <div id="diagonal-results" style="display:none;">
            <div class="result-box" style="background:#f3e5f5;border-color:#9c27b0;">
                <div>Diagonal Measurement:</div>
                <div id="diagonal-feet-inches" style="font-size:24px;">-</div>
            </div>
            <div class="result-box" style="background:#e8f5e9;border-color:#4CAF50;">
                <div>Diagonal in Decimal Feet:</div>
                <div id="diagonal-decimal" style="font-size:20px;">-</div>
            </div>
        </div>
    </div>

    <div id="error-message" class="error-box" style="display:none;"></div>

    <!-- JAVASCRIPT -->
    <script>
        // Generate fraction options for dropdown selectors
        function generateFractionOptions() {
            const fractions = [
                {value: "0", text: "0"},
                {value: "1/16", text: "1/16"},
                {value: "1/8", text: "1/8"},
                {value: "3/16", text: "3/16"},
                {value: "1/4", text: "1/4"},
                {value: "5/16", text: "5/16"},
                {value: "3/8", text: "3/8"},
                {value: "7/16", text: "7/16"},
                {value: "1/2", text: "1/2"},
                {value: "9/16", text: "9/16"},
                {value: "5/8", text: "5/8"},
                {value: "11/16", text: "11/16"},
                {value: "3/4", text: "3/4"},
                {value: "13/16", text: "13/16"},
                {value: "7/8", text: "7/8"},
                {value: "15/16", text: "15/16"}
            ];
            
            let options = '';
            fractions.forEach(fraction => {
                options += `<option value="${fraction.value}">${fraction.text}</option>`;
            });
            return options;
        }

        // Populate all fraction selectors on page load
        window.addEventListener('DOMContentLoaded', () => {
            const fractionOptions = generateFractionOptions();
            document.querySelectorAll('.fraction-select').forEach(select => {
                select.innerHTML = fractionOptions;
                select.value = "0"; // default to 0
            });
        });

        function toggleFooterType() {
            const footerType = document.querySelector('input[name="footer-type"]:checked').value;
            document.getElementById('basement-section').style.display = footerType === 'basement' ? 'block' : 'none';
            document.getElementById('block-section').style.display = footerType === 'block' ? 'block' : 'none';
            document.getElementById('diagonal-section').style.display = footerType === 'diagonal' ? 'block' : 'none';
            hideError();
        }

        function showError(message) {
            const errorBox = document.getElementById('error-message');
            errorBox.textContent = message;
            errorBox.style.display = 'block';
        }

        function hideError() {
            document.getElementById('error-message').style.display = 'none';
        }

        function decimalToFeetInches(decimal) {
            const feet = Math.floor(decimal);
            const inches = (decimal - feet) * 12;
            const wholeInches = Math.floor(inches);
            const fraction = inches - wholeInches;
            
            // Convert fraction to 16ths
            const sixteenths = Math.round(fraction * 16);
            
            let fractionStr = '';
            if (sixteenths > 0) {
                // Simplify fraction
                let num = sixteenths;
                let den = 16;
                const gcd = (a, b) => b === 0 ? a : gcd(b, a % b);
                const g = gcd(num, den);
                num /= g;
                den /= g;
                fractionStr = ` ${num}/${den}`;
            }
            
            return `${feet}' ${wholeInches}${fractionStr}"`;
        }

        function feetInchesToDecimal(ft, inches, fractionSelect) {
            let decimal = parseFloat(ft) || 0;
            decimal += (parseFloat(inches) || 0) / 12;
            
            const fractionValue = fractionSelect.value;
            if (fractionValue && fractionValue !== "0" && fractionValue.includes('/')) {
                const parts = fractionValue.split('/');
                decimal += (parseFloat(parts[0]) / parseFloat(parts[1])) / 12;
            }
            
            return decimal;
        }

        function calculateBasement() {
            hideError();
            
            const currentElevation = parseFloat(document.getElementById('current-elevation-basement').value);
            const footerElevation = parseFloat(document.getElementById('footer-elevation-basement').value);
            const gradeRodFt = document.getElementById('grade-rod-ft-basement').value;
            const gradeRodIn = document.getElementById('grade-rod-in-basement').value;
            const gradeRodFraction = document.getElementById('grade-rod-fraction-basement');
            
            if (isNaN(currentElevation) || isNaN(footerElevation)) {
                showError('Please enter valid elevation values');
                return;
            }
            
            // Calculate difference
            const difference = currentElevation - footerElevation;
            
            // Get current grade rod reading in decimal
            const currentGradeRod = feetInchesToDecimal(gradeRodFt, gradeRodIn, gradeRodFraction);
            
            // Calculate new grade rod setting
            const newGradeRod = currentGradeRod + difference;
            
            // Display results
            document.getElementById('difference-decimal-basement').textContent = difference.toFixed(2) + ' ft';
            document.getElementById('grade-rod-setting-basement').textContent = decimalToFeetInches(newGradeRod);
            document.getElementById('slab-height-basement').textContent = decimalToFeetInches(newGradeRod);
            // FIXED: Sub grade calculation - now properly 1 foot lower than footer
            document.getElementById('sub-grade-basement').textContent = decimalToFeetInches(newGradeRod + 1);
            
            document.getElementById('basement-results').style.display = 'block';
        }

        function calculateBlock() {
            hideError();
            
            const finishedFloor = parseFloat(document.getElementById('finished-floor').value);
            const floorSystem = parseFloat(document.getElementById('floor-system').value);
            const blockCourses = parseInt(document.getElementById('block-courses').value);
            const currentElevation = parseFloat(document.getElementById('current-elevation-block').value);
            const gradeRodFt = document.getElementById('grade-rod-ft-block').value;
            const gradeRodIn = document.getElementById('grade-rod-in-block').value;
            const gradeRodFraction = document.getElementById('grade-rod-fraction-block');
            
            if (isNaN(finishedFloor) || isNaN(floorSystem) || isNaN(blockCourses) || isNaN(currentElevation)) {
                showError('Please enter valid values for all fields');
                return;
            }
            
            // Calculate total deduction in inches
            const blockHeight = blockCourses * 8; // 8 inches per course
            const totalInches = floorSystem + blockHeight;
            const totalFeet = totalInches / 12;
            
            // Calculate footer elevation
            const footerElevation = finishedFloor - totalFeet;
            
            // Calculate difference from current elevation
            const difference = currentElevation - footerElevation;
            
            // Get current grade rod reading in decimal
            const currentGradeRod = feetInchesToDecimal(gradeRodFt, gradeRodIn, gradeRodFraction);
            
            // Calculate new grade rod setting
            const newGradeRod = currentGradeRod + difference;
            
            // Display results
            document.getElementById('total-deduction').textContent = `${totalInches}" (${totalFeet.toFixed(2)}')`;
            document.getElementById('calc-footer-elevation').textContent = footerElevation.toFixed(2) + ' ft';
            document.getElementById('footer-height-decimal').textContent = difference.toFixed(2) + ' ft';
            document.getElementById('block-grade-rod-setting').textContent = decimalToFeetInches(newGradeRod);
            
            document.getElementById('block-results').style.display = 'block';
        }

        function calculateDiagonal() {
            hideError();
            
            const lengthFt = document.getElementById('length-ft').value;
            const lengthIn = document.getElementById('length-in').value;
            const lengthFraction = document.getElementById('length-fraction');
            
            const widthFt = document.getElementById('width-ft').value;
            const widthIn = document.getElementById('width-in').value;
            const widthFraction = document.getElementById('width-fraction');
            
            // Convert to decimal feet
            const lengthDecimal = feetInchesToDecimal(lengthFt, lengthIn, lengthFraction);
            const widthDecimal = feetInchesToDecimal(widthFt, widthIn, widthFraction);
            
            if (lengthDecimal <= 0 || widthDecimal <= 0) {
                showError('Please enter valid length and width values');
                return;
            }
            
            // Calculate diagonal using Pythagorean theorem
            const diagonal = Math.sqrt(lengthDecimal * lengthDecimal + widthDecimal * widthDecimal);
            
            // Display results
            document.getElementById('diagonal-feet-inches').textContent = decimalToFeetInches(diagonal);
            document.getElementById('diagonal-decimal').textContent = diagonal.toFixed(3) + ' ft';
            
            document.getElementById('diagonal-results').style.display = 'block';
        }

        // Enter key navigation
        document.addEventListener('keydown', e => {
            if(e.key === 'Enter'){
                e.preventDefault();
                const inputs = [...document.querySelectorAll('input:not([type=radio]), select')];
                const idx = inputs.indexOf(document.activeElement);
                if(idx !== -1 && idx < inputs.length - 1) {
                    inputs[idx + 1].focus();
                }
            }
        });
    </script>

</div>
</body>
</html>
